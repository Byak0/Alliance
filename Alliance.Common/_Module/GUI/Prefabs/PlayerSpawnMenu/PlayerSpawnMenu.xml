<Prefab>
	<Constants>
		<Constant Name="FormationList.Width" Value="480" />
	</Constants>
	<Window>

		<!-- Transparent background covering all the screen. If user clicks on it, close the menu -->
		<ButtonWidget WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" Brush="Alliance.TransparentBrush" Sprite="Frame1_canvas" Command.Click="CloseMenu">
			<Children>

				<!-- Main window -->
				<BrushWidget WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" HorizontalAlignment="Center" SuggestedWidth="1920" SuggestedHeight="1080" VerticalAlignment="Center" Brush="Alliance.UniformFrame" Sprite="BlankWhiteSquare_9" Brush.AlphaFactor="0.6">
					<Children>

						<!-- Top Center : Team & Formation names -->
						<BrushWidget WidthSizePolicy="StretchToParent" HeightSizePolicy="Fixed" SuggestedHeight="48" HorizontalAlignment="Center" VerticalAlignment="Top" Brush="MPLobby.TopHeader.Background" Brush.AlphaFactor="0.8">
							<Children>
								<RichTextWidget WidthSizePolicy="Fixed" SuggestedWidth="700" HeightSizePolicy="Fixed" SuggestedHeight="48" HorizontalAlignment="Center" VerticalAlignment="Center" Brush="MPLobby.ClassFilter.ClassTuple.Text" Brush.TextHorizontalAlignment="Center" Brush.TextVerticalAlignment="Center" Brush.FontSize="32" MarginTop="4" Text="@MenuTitle" />
							</Children>
						</BrushWidget>

						<!-- Top Left : Preferred language -->
						<BrushWidget WidthSizePolicy="Fixed" SuggestedWidth="520" HeightSizePolicy="Fixed" SuggestedHeight="60" HorizontalAlignment="Left" VerticalAlignment="Top" MarginTop="6" >
							<Children>
								<GenericOption DataSource="{PreferredLanguage}" />
							</Children>
						</BrushWidget>

						<!-- Top : Sync / Load / Save / Edit buttons (admin only) -->
						<BrushWidget SuggestedWidth="640" SuggestedHeight="60" VerticalAlignment="Top" HorizontalAlignment="Right" IsVisible="@IsAdmin" >
							<Children>

								<!-- Sync button -->
								<ButtonWidget DoNotPassEventsToChildren="true" WidthSizePolicy="Fixed" SuggestedWidth="160" HeightSizePolicy="Fixed" SuggestedHeight="56" HorizontalAlignment="Left" VerticalAlignment="Top" Brush="Popup.Done.Button" UpdateChildrenStates="true" GamepadNavigationIndex="1" Command.Click="Sync" IsVisible="@EditMode">
									<Children>
										<BrushWidget WidthSizePolicy="Fixed" SuggestedWidth="60" HeightSizePolicy="Fixed" SuggestedHeight="48" HorizontalAlignment="Left" VerticalAlignment="Center" MarginLeft="12" Brush="MPLobby.Matchmaking.CustomGameListButton" UpdateChildrenStates="true" GamepadNavigationIndex="1" Brush.AlphaFactor="0.8" IsVisible="@EditMode" />
										<TextWidget WidthSizePolicy="Fixed" SuggestedWidth="100" HeightSizePolicy="StretchToParent" Brush="MPLobby.ClassFilter.ClassTuple.Text" Brush.FontSize="24" Brush.TextHorizontalAlignment="Center" Brush.TextVerticalAlignment="Center" HorizontalAlignment="Left" VerticalAlignment="Center" MarginLeft="36" Text="Sync" />
									</Children>
								</ButtonWidget>

								<!-- Load button -->
								<ButtonWidget DoNotPassEventsToChildren="true" WidthSizePolicy="Fixed" SuggestedWidth="160" HeightSizePolicy="Fixed" SuggestedHeight="56" HorizontalAlignment="Right" VerticalAlignment="Top" MarginRight="320" Brush="Popup.Done.Button" UpdateChildrenStates="true" GamepadNavigationIndex="1" Command.Click="Load" IsVisible="@EditMode">
									<Children>
										<TextWidget WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" Brush="MPLobby.ClassFilter.ClassTuple.Text" Brush.FontSize="24" Brush.TextHorizontalAlignment="Center" Brush.TextVerticalAlignment="Center" HorizontalAlignment="Center" VerticalAlignment="Center" Text="Load" />
									</Children>
								</ButtonWidget>

								<!-- Save button -->
								<ButtonWidget DoNotPassEventsToChildren="true" WidthSizePolicy="Fixed" SuggestedWidth="160" HeightSizePolicy="Fixed" SuggestedHeight="56" HorizontalAlignment="Right" VerticalAlignment="Top" MarginRight="160" Brush="Popup.Done.Button" UpdateChildrenStates="true" GamepadNavigationIndex="1" Command.Click="Save" IsVisible="@EditMode">
									<Children>
										<TextWidget WidthSizePolicy="StretchToParent" HeightSizePolicy="StretchToParent" Brush="MPLobby.ClassFilter.ClassTuple.Text" Brush.FontSize="24" Brush.TextHorizontalAlignment="Center" Brush.TextVerticalAlignment="Center" HorizontalAlignment="Center" VerticalAlignment="Center" Text="Save" />
									</Children>
								</ButtonWidget>

								<!-- Edit mode -->
								<TextWidget WidthSizePolicy="Fixed" SuggestedWidth="120" HeightSizePolicy="Fixed" SuggestedHeight="40" MarginRight="24" HorizontalAlignment="Right" VerticalAlignment="Center" Brush="MPLobby.ClassFilter.ClassTuple.Text" Brush.FontSize="24" Text="Edit mode : " />

								<!-- Edit checkbox -->
								<ButtonWidget ButtonType="Toggle" DoNotPassEventsToChildren="true" WidthSizePolicy="Fixed" SuggestedWidth="44" HeightSizePolicy="Fixed" SuggestedHeight="44" VerticalAlignment="Center" HorizontalAlignment="Right" Brush="Alliance.Button.Checkbox" UpdateChildrenStates="true" GamepadNavigationIndex="1" IsSelected="@EditMode" />

							</Children>
						</BrushWidget>


						<!-- Left : Team list, scrollable (Edit mode only) -->
						<BrushWidget SuggestedWidth="!FormationList.Width" SuggestedHeight="48" VerticalAlignment="Top" HorizontalAlignment="Left" IsVisible="@EditMode" MarginTop="60" >
							<Children>
								<ScrollablePanel Id="ScrollablePanelTeams" HeightSizePolicy ="StretchToParent" WidthSizePolicy="StretchToParent" InnerPanel="ClipRectTeams\InnerPanelTeams" ClipRect="ClipRectTeams" HorizontalScrollbar="..\ScrollbarTeams" AutoHideScrollBars="true" MarginBottom="4" >
									<Children>
										<Widget Id="ClipRectTeams" WidthSizePolicy="Fixed" SuggestedWidth="!FormationList.Width" HeightSizePolicy="StretchToParent" HorizontalAlignment="Center" ClipContents="true" >
											<Children>
												<NavigatableListPanel Id="InnerPanelTeams" WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" HorizontalAlignment="Center" MarginLeft="10" MarginRight="10">
													<Children>
														<ListPanel DataSource="{Teams}"  WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" HorizontalAlignment="Center">
															<ItemTemplate>
																<!-- Team item -->
																<TeamItem/>
															</ItemTemplate>
														</ListPanel>
														<!-- Add Team button -->
														<ButtonWidget DoNotPassEventsToChildren="true" WidthSizePolicy="Fixed" SuggestedWidth="40" HeightSizePolicy="Fixed" SuggestedHeight="40"  HorizontalAlignment="Center" Brush="MPLobby.Clan.AddAnnouncement.Button" UpdateChildrenStates="true" GamepadNavigationIndex="1" Command.Click="AddTeam" />
													</Children>
												</NavigatableListPanel>
											</Children>
										</Widget>
									</Children>
								</ScrollablePanel>
								<!-- Horizontal scrollbar -->
								<ScrollbarWidget Id="ScrollbarTeams" WidthSizePolicy="StretchToParent" HeightSizePolicy="Fixed" SuggestedHeight="4" VerticalAlignment="Bottom" AlignmentAxis="Horizontal" Handle="ScrollbarHandleTeams" MaxValue="100" MinValue="0" >
									<Children>
										<Widget WidthSizePolicy="StretchToParent" HeightSizePolicy="Fixed" SuggestedHeight="4" HorizontalAlignment="Center" Sprite="MPLobby\CustomServer\lobby_slider_bed" AlphaFactor="0.2" />
										<ImageWidget Id="ScrollbarHandleTeams" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedHeight="6" HorizontalAlignment="Center" VerticalAlignment="Top" Brush="FaceGen.Scrollbar.Handle" MinWidth="8" />
									</Children>
								</ScrollbarWidget>
							</Children>
						</BrushWidget>



						<!-- Left part : Formation list -->
						<BrushWidget SuggestedWidth="!FormationList.Width" HeightSizePolicy="StretchToParent" SuggestedHeight="800" VerticalAlignment="Top" HorizontalAlignment="Left" MarginTop="108" >
							<Children>
								<ScrollablePanel Id="ScrollablePanelFormations" HeightSizePolicy ="StretchToParent" WidthSizePolicy="StretchToParent" InnerPanel="ClipRectFormations\InnerPanelFormations" ClipRect="ClipRectFormations" VerticalScrollbar="..\ScrollbarFormations" AutoHideScrollBars="true" MarginBottom="4" >
									<Children>
										<Widget Id="ClipRectFormations" WidthSizePolicy="Fixed" SuggestedWidth="!FormationList.Width" HeightSizePolicy="StretchToParent" HorizontalAlignment="Center" ClipContents="true" >
											<Children>
												<NavigatableListPanel Id="InnerPanelFormations" WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" HorizontalAlignment="Center" MarginLeft="10" MarginRight="10" StackLayout.LayoutMethod="VerticalBottomToTop">
													<Children>
														<ListPanel DataSource="{Formations}"  WidthSizePolicy="CoverChildren" HeightSizePolicy="CoverChildren" HorizontalAlignment="Center" StackLayout.LayoutMethod="VerticalBottomToTop" MarginTop="8">
															<ItemTemplate>
																<FormationItem/>
															</ItemTemplate>
														</ListPanel>
														<!-- Add Formation button -->
														<ButtonWidget DoNotPassEventsToChildren="true" WidthSizePolicy="Fixed" SuggestedWidth="80" HeightSizePolicy="Fixed" SuggestedHeight="80"  HorizontalAlignment="Center" Brush="MPLobby.Clan.AddAnnouncement.Button" UpdateChildrenStates="true" GamepadNavigationIndex="1" Command.Click="AddFormation" IsVisible="@EditMode" MarginTop="36"/>
													</Children>
												</NavigatableListPanel>
											</Children>
										</Widget>
									</Children>
								</ScrollablePanel>
								<!-- Vertical scrollbar -->
								<ScrollbarWidget Id="ScrollbarFormations" WidthSizePolicy="Fixed" HeightSizePolicy="StretchToParent" SuggestedWidth="4" HorizontalAlignment="Right" AlignmentAxis="Vertical" Handle="ScrollbarHandleFormations" MaxValue="100" MinValue="0" MarginRight="1" MarginTop="8">
									<Children>
										<Widget WidthSizePolicy="Fixed" HeightSizePolicy="StretchToParent" SuggestedWidth="4" HorizontalAlignment="Center" Sprite="MPLobby\CustomServer\lobby_slider_bed" AlphaFactor="0.2" />
										<ImageWidget Id="ScrollbarHandleFormations" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed" SuggestedWidth="6" HorizontalAlignment="Center" VerticalAlignment="Top" Brush="FaceGen.Scrollbar.Handle" MinHeight="8" />
									</Children>
								</ScrollbarWidget>
							</Children>
						</BrushWidget>

						<!-- Right part : Officer election -->
						<BrushWidget WidthSizePolicy="StretchToParent" SuggestedHeight="380" VerticalAlignment="Top" HorizontalAlignment="Right" MarginLeft="480" MarginTop="60" >
							<Children>
								<RichTextWidget WidthSizePolicy="StretchToParent" HeightSizePolicy="Fixed" SuggestedHeight="60" HorizontalAlignment="Center" VerticalAlignment="Top" Brush="MPLobby.ClassFilter.ClassTuple.Text" Brush.TextHorizontalAlignment="Center" Brush.TextVerticalAlignment="Center" Brush.FontSize="28" MarginTop="4" Text="Vote for your officer (multiple choices possible) - 30s remaining" />
								<ListPanel DataSource="{OfficerCandidacies}" WidthSizePolicy="StretchToParent" SuggestedHeight="420" VerticalAlignment="Top" HorizontalAlignment="Center"  ClipContents="true" ClipHorizontalContent="true" ClipVerticalContent="true" StackLayout.LayoutMethod="HorizontalCentered">
									<ItemTemplate>
										<OfficerCandidacyItem/>
									</ItemTemplate>
								</ListPanel>
							</Children>
						</BrushWidget>




						<!-- Bottom right part : Character choice -->
						<BrushWidget WidthSizePolicy="StretchToParent" SuggestedHeight="640" HorizontalAlignment="Left" VerticalAlignment="Bottom" MarginLeft="480" >
							<Children>
								<RichTextWidget WidthSizePolicy="StretchToParent" HeightSizePolicy="Fixed" SuggestedHeight="60" HorizontalAlignment="Center" VerticalAlignment="Top" Brush="MPLobby.ClassFilter.ClassTuple.Text" Brush.TextHorizontalAlignment="Center" Brush.TextVerticalAlignment="Center" Brush.FontSize="28" MarginTop="4" Text="Choose your class :" />
								<ListPanel WidthSizePolicy="StretchToParent" HeightSizePolicy="Fixed" SuggestedHeight="580" VerticalAlignment="Center" HorizontalAlignment="Center" MarginTop="60" StackLayout.LayoutMethod="HorizontalCentered">
									<Children>
										<Widget DataSource="{Characters}" WidthSizePolicy="CoverChildren" HeightSizePolicy="StretchToParent" VerticalAlignment="Center" HorizontalAlignment="Center" >
											<ItemTemplate>
												<CharacterItem/>
											</ItemTemplate>
										</Widget>
										<!-- Add Character button -->
										<ButtonWidget DoNotPassEventsToChildren="true" WidthSizePolicy="Fixed" SuggestedWidth="80" HeightSizePolicy="Fixed" SuggestedHeight="80"  HorizontalAlignment="Center" VerticalAlignment="Center" Brush="MPLobby.Clan.AddAnnouncement.Button" UpdateChildrenStates="true" GamepadNavigationIndex="1" Command.Click="AddCharacter" IsVisible="@EditMode" />
									</Children>
								</ListPanel>
								<!--<CharacterSelectionWidget Formations="@Formations" CurrentFormationIndex="@SelectedFormationIndex" EditMode="@EditMode" SuggestedWidth="1280" SuggestedHeight="640" VerticalAlignment="Center" HorizontalAlignment="Center" WidthSizePolicy="Fixed" HeightSizePolicy="Fixed"  />-->
							</Children>
						</BrushWidget>

					</Children>
				</BrushWidget>


			</Children>
		</ButtonWidget>

	</Window>
</Prefab>